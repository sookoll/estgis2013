<!DOCTYPE html>
<html>
    
    <head>
        <title>OL3 - Overlays</title>
        <link rel="stylesheet" href="../lib/ol/ol.css" type="text/css">
        <link rel="stylesheet" href="../lib/bootstrap-3.0.0/dist/css/bootstrap.min.css" type="text/css">
        <style>
            html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            div.full {
                width: 100%;
                height: 100%;
            }
            #info {
                position: absolute;
                top: 20px;
                right: 20px;
            }
        </style>
    </head>
    
    <body>
        <div id="map" class="full"></div>
        <div id="popup" title="hello from ol3">
            <a href="#" id="popup-closer" class="ol-popup-closer"></a>
            <div id="popup-content"></div>
        </div>
        <div id="info" class="alert alert-info">
            <button data-dismiss="alert" class="close">&times;</button>
            <strong>Hint:</strong>
            <span>Click on the map to see a popup.</span>
        </div>
        <script src="../lib/js/jquery-2.0.3.min.js" type="text/javascript"></script>
        <script src="../lib/bootstrap-3.0.0/dist/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="../lib/ol/ol.js" type="text/javascript"></script>
        <script>
            var map = new ol.Map({
                target: 'map',
                renderer: ol.RendererHint.CANVAS,
                layers: [
                    new ol.layer.Tile({
                        source: new ol.source.OSM({
                            //layer: 'watercolor'
                        })
                    }),
                    new ol.layer.Tile({
                        source: new ol.source.TileWMS({
                            url: 'http://kaart.maakaart.ee/service',
                            params: {
                                'LAYERS': 'osm',
                                'TILED': true
                            },
                            extent: [-20037508.34, -20037508.34, 20037508.34, 20037508.34],
                            //crossOrigin: 'anonymous',
                        })
                    })
                    /*,

                    new ol.layer.Tile({
                        source: new ol.source.OSM({
                            //layer: 'watercolor'
                        })
                    })*/
                ],
                view: new ol.View2D({
                    center: [0,0],
                    zoom: 1
                    //projection: new ol.proj.Projection('EPSG:900913')
                    //extent: [-20037508.34, -20037508.34, 20037508.34, 20037508.34]
                })
            });

            var popup = new ol.Overlay({
                //map: map,
                element: document.getElementById('popup')
            });

            map.addOverlay(popup);

            var hdms;

            function getContent() {
                return '<p>The location you clicked is:</p><code>' + hdms + '</code>';
            }

            map.on('click', function(evt) {
                var element = popup.getElement();
                var coordinate = evt.getCoordinate();
                hdms = ol.coordinate.toStringHDMS(ol.proj.transform(
                    coordinate, 'EPSG:3857', 'EPSG:4326'));
                popup.setPosition(coordinate);
                $(element).popover({
                    'placement': 'left',
                    'html': true,
                    'content': getContent
                });
                $(element).popover('show');

            });

        </script>
    </body>

</html>