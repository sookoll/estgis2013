<!doctype html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
        <link rel="stylesheet" href="../lib/ol/ol.css" type="text/css">
        <link rel="stylesheet" href="../lib/bootstrap-3.0.0/dist/css/bootstrap.min.css" type="text/css">
        <style>
            html, body {
                height:100%
            }
            .map {
                height: 100%;
                width: 100%;
            }
            
            
        </style>
        <title>ESTGIS demo</title>
    </head>
    
    <body>
        <div id="map" class="map"></div>
        <div id="popup" class="ol-popup">
            <a href="#" id="popup-closer" class="ol-popup-closer"></a>
            <div id="popup-content"></div>
        </div>
        <script src="../lib/js/jquery-2.0.3.min.js" type="text/javascript"></script>
        <script src="../lib/bootstrap-3.0.0/dist/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="../lib/ol/ol.js" type="text/javascript"></script>
        <script type="text/javascript">
            var raster = new ol.layer.Tile({
                source: new ol.source.TileJSON({
                    url: 'http://api.tiles.mapbox.com/v3/mapbox.world-dark.jsonp'
                })
            });

            var vector = new ol.layer.Vector({
                source: new ol.source.Vector({
                    url: 'data/world-110m.topo.json',
                    parser: new ol.parser.TopoJSON()
                }),
                style: new ol.style.Style({
                    symbolizers: [
                            new ol.style.Fill({
                            color: '#BADA55',
                            opacity: 0.5
                        }),
                            new ol.style.Stroke({
                            color: '#FFF',
                            opacity: 1,
                            width: 1.5
                        })
                    ]
                })
            });

            var map = new ol.Map({
                //layers: [raster, vector],
                layers: [raster],
                renderer: ol.RendererHint.CANVAS,
                target: 'map',
                view: new ol.View2D({
                    center: [0, 0],
                    zoom: 2
                })
            });

            /**
             * Elements that make up the popup.
             */
            var container = document.getElementById('popup');
            var content = document.getElementById('popup-content');
            var closer = document.getElementById('popup-closer');

            /**
             * Add a click handler to hide the popup.
             * @return {boolean} Don't follow the href.
             */
            closer.onclick = function() {
                container.style.display = 'none';
                closer.blur();
                return false;
            };

            /**
             * Create an overlay to anchor the popup to the map.
             */
            var overlay = new ol.Overlay({
                element: container
            });

            map.addOverlay(overlay);

            /**
             * Add a click handler to the map to render the popup.
             */
            map.on('click', function(evt) {
                container.style.display = 'none';
                var coordinate = evt.getCoordinate();
                var hdms = ol.coordinate.toStringHDMS(ol.proj.transform(
                    coordinate, 'EPSG:3857', 'EPSG:4326'));

                overlay.setPosition(coordinate);
                content.innerHTML = '<p>You clicked here:</p><code>' + hdms +
                    '</code>';
                container.style.display = 'block';
            });
            /*
            var element = document.getElementById('popup');
            var popup = new ol.Overlay({
                element: element,
                positioning: ol.OverlayPositioning.BOTTOM_CENTER
            });
            map.addOverlay(popup);

            map.on('click', function(evt) {
                map.getFeatures({
                    pixel: evt.getPixel(),
                    layers: [vector],
                    success: function(layerFeatures) {
                        var feature = layerFeatures[0][0];
                        if (feature) {
                            var coord = evt.getCoordinate();
                            console.log(coord);
                            popup.setPosition(coord);
                            $(element).popover({
                                'placement': 'top',
                                'html': true,
                                'content': feature.get('name')
                            });
                            $(element).popover('show');
                        } else {
                            $(element).popover('destroy');
                        }
                    }
                });
            });*/
        </script>
    </body>

</html>